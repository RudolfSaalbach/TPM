{% extends "admin/base.html" %}

{% block title %}Systeminformationen - Chronos Admin{% endblock %}
{% block header_title %}System &amp; Infrastruktur{% endblock %}
{% block header_subtitle %}Status&uuml;berblick, Datenbankgesundheit und Laufzeitumgebung{% endblock %}

{% block content %}
<nav class="breadcrumb">
    <a href="/admin">Admin</a>
    <span>/</span>
    <span>Systeminformationen</span>
</nav>

<div class="page-header">
    <div>
        <h1>Systemstatus</h1>
        <p>Version 2.1.0 &middot; Umgebung: {{ db_info.environment | default('Unknown') }}</p>
    </div>
    <div class="header-actions">
        <a class="btn btn-secondary" href="/docs" target="_blank">API Docs</a>
        <a class="btn btn-secondary" href="/health" target="_blank">Health Check</a>
    </div>
</div>

{% if db_info.error %}
<div class="info-panel" style="border-color: rgba(255, 71, 87, 0.4); background: rgba(255, 71, 87, 0.08);">
    <h4>Datenbank-Fehler</h4>
    <p>{{ db_info.error }}</p>
</div>
{% else %}
<div class="stats-grid">
    <div class="stat-card">
        <span class="stat-label">Tabellen</span>
        <span class="stat-value">{{ db_info.tables | length }}</span>
    </div>
    <div class="stat-card">
        <span class="stat-label">Laufzeit (Uptime)</span>
        <span class="stat-value">{{ db_info.uptime | default('n/a') }}</span>
    </div>
    <div class="stat-card">
        <span class="stat-label">Python Version</span>
        <span class="stat-value">{{ db_info.python_version | default('n/a') }}</span>
    </div>
    <div class="stat-card">
        <span class="stat-label">Plattform</span>
        <span class="stat-value">{{ db_info.platform | default('n/a') }}</span>
    </div>
</div>

{% set table_counts = db_info.table_counts | default({}, true) %}
<div class="table-card">
    <table>
        <thead>
            <tr>
                <th>Tabelle</th>
                <th>Eintr&auml;ge</th>
            </tr>
        </thead>
        <tbody>
            {% for table in db_info.tables %}
            {% if not table.startswith('sqlite_') %}
            <tr>
                <td>{{ table }}</td>
                <td>{{ table_counts.get(table) | default('n/a') }}</td>
            </tr>
            {% endif %}
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

<div class="info-panel">
    <h4>Systemhinweise</h4>
    <ul>
        <li>Nutze den Health Check, um die API-Verf&uuml;gbarkeit zu pr&uuml;fen.</li>
        <li>Datenbanktabellen mit hoher Eintragszahl sollten regelma&szlig;ig archiviert werden.</li>
        <li>Die Plattform- und Python-Version helfen bei der Fehlerdiagnose.</li>
    </ul>
</div>
{% endblock %}

